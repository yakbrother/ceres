---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Sidebar from '../components/Sidebar.astro';
---

<BaseLayout title="Page Not Found" description="The page you're looking for doesn't exist" layout="docs">
  <Header />
  <Sidebar />
  
  <main id="main-content" class="main-content" role="main">
    <div class="error-page gradient-bottom-right">
    <div class="error-content">
      <div class="error-visual">
        <div class="error-number">404</div>
        <div class="error-icon">
          <i class="fas fa-search" aria-hidden="true"></i>
        </div>
      </div>
      
      <div class="error-text">
        <h1 class="error-title">Page Not Found</h1>
        <p class="error-description">
          Sorry, we couldn't find the page you're looking for. 
          It might have been moved, deleted, or you entered the wrong URL.
        </p>
        
        <div class="error-actions">
          <a href="/" class="btn btn--primary">
            <i class="fas fa-home" aria-hidden="true"></i>
            Go Home
          </a>
          <a href="/docs/getting-started/introduction" class="btn btn--secondary">
            <i class="fas fa-book" aria-hidden="true"></i>
            Browse Docs
          </a>
        </div>
        
        <div class="error-search">
          <form role="search" class="error-search-form">
            <label for="error-search-input" class="error-search-label">Or try searching for what you need:</label>
            <div class="error-search-bar">
              <input 
                type="search" 
                placeholder="Search documentation..."
                class="error-search-input"
                id="error-search-input"
                name="query"
                aria-label="Search documentation"
                aria-describedby="error-search-help"
              />
              <button 
                type="submit"
                class="error-search-btn" 
                id="error-search-btn"
                aria-label="Search"
              >
                <i class="fas fa-search" aria-hidden="true"></i>
              </button>
            </div>
            <div id="error-search-help" class="sr-only">
              Press Enter or click the search button to search documentation
            </div>
          </form>
        </div>
      </div>
    </div>
    </div>
  </main>
  
  <Footer />
</BaseLayout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const searchForm = document.querySelector('.error-search-form');
    const searchInput = document.getElementById('error-search-input');
    const searchBtn = document.getElementById('error-search-btn');
    
    function performSearch(event?: Event) {
      if (event) {
        event.preventDefault();
      }
      
      const input = searchInput as HTMLInputElement;
      const query = input?.value.trim();
      
      if (!query) {
        // Provide accessible feedback for empty searches
        input?.focus();
        return;
      }
      
      // Redirect to homepage with search query
      window.location.href = `/?search=${encodeURIComponent(query)}`;
    }
    
    // Handle form submission
    searchForm?.addEventListener('submit', performSearch);
    
    // Fallback for button click (form submission should handle this)
    searchBtn?.addEventListener('click', (e) => {
      if (!searchForm) {
        performSearch(e);
      }
    });
    
    // Additional keyboard support for older browsers
    searchInput?.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !searchForm) {
        performSearch(e);
      }
    });
  });
</script>

<style>
  .main-content {
    grid-area: main;
    min-width: 0;
    padding: var(--space-s);
    max-width: 100%;
  }
  
  .error-page {
    min-height: calc(100vh - var(--header-height) - 2 * var(--space-s));
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-xl) var(--space-s);
  }
  
  .error-content {
    max-width: 600px;
    text-align: center;
  }
  
  .error-visual {
    position: relative;
    margin-bottom: var(--space-xl);
  }
  
  .error-number {
    font-size: clamp(4rem, 15vw, 8rem);
    font-weight: 900;
    color: var(--color-accent);
    opacity: 0.1;
    line-height: 1;
    margin-bottom: var(--space-s);
  }
  
  .error-icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: var(--step-4);
    color: var(--color-accent);
  }
  
  .error-title {
    font-size: var(--step-3);
    font-weight: 700;
    color: var(--color-text-primary);
    margin-bottom: var(--space-m);
  }
  
  .error-description {
    font-size: var(--step-0);
    color: var(--color-text-secondary);
    line-height: 1.6;
    margin-bottom: var(--space-xl);
  }
  
  .error-actions {
    display: flex;
    gap: var(--space-s);
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: var(--space-xl);
  }
  
  .btn {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-s) var(--space-m);
    border-radius: var(--radius-lg);
    font-weight: 600;
    text-decoration: none;
    transition: all var(--transition-fast);
    border: 2px solid transparent;
  }
  
  .btn--primary {
    background-color: var(--color-accent);
    color: white;
  }
  
  .btn--primary:hover {
    background-color: var(--color-accent-hover);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
    text-decoration: none;
  }
  
  .btn--secondary {
    background-color: transparent;
    color: var(--color-text-primary);
    border-color: var(--color-border-medium);
  }
  
  .btn--secondary:hover {
    background-color: var(--color-bg-secondary);
    border-color: var(--color-accent);
    color: var(--color-accent);
    transform: translateY(-2px);
    text-decoration: none;
  }
  
  .error-search {
    padding-top: var(--space-l);
    border-top: 1px solid var(--color-border-light);
  }
  
  .error-search-form {
    width: 100%;
  }
  
  .error-search-label {
    color: var(--color-text-muted);
    font-size: var(--step--1);
    margin-bottom: var(--space-s);
    display: block;
    text-align: center;
  }
  
  .error-search-bar {
    display: flex;
    max-width: 400px;
    margin: 0 auto;
    background-color: var(--color-surface-elevated);
    border: 1px solid var(--color-border-medium);
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
  }
  
  .error-search-input {
    flex: 1;
    padding: var(--space-s);
    border: none;
    background: transparent;
    color: var(--color-text-primary);
    font-size: var(--step--1);
  }
  
  .error-search-input:focus {
    outline: none;
  }
  
  .error-search-input::placeholder {
    color: var(--color-text-muted);
  }
  
  .error-search-btn {
    padding: var(--space-s);
    background-color: var(--color-accent);
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color var(--transition-fast);
  }
  
  .error-search-btn:hover {
    background-color: var(--color-accent-hover);
  }
  
  /* Mobile Styles */
  @media (max-width: 1024px) {
    .main-content {
      padding: var(--space-xs);
    }
  }
  
  @media (max-width: 640px) {
    .error-page {
      padding: var(--space-l) var(--space-xs);
    }
    
    .error-title {
      font-size: var(--step-2);
    }
    
    .error-description {
      font-size: var(--step--1);
    }
    
    .error-actions {
      flex-direction: column;
      align-items: center;
    }
    
    .btn {
      width: 100%;
      max-width: 200px;
      justify-content: center;
    }
  }
</style>