---
// Example accessible table component for documentation
// This demonstrates proper table accessibility patterns

export interface Props {
  caption: string;
  headers: string[];
  rows: (string | number)[][];
  rowHeaders?: boolean; // Whether first column contains row headers
  responsive?: boolean; // Whether to use responsive mobile layout
  id?: string;
  ariaLabel?: string;
}

const {
  caption,
  headers,
  rows,
  rowHeaders = false,
  responsive = false,
  id,
  ariaLabel
} = Astro.props;

const tableId = id || `table-${Math.random().toString(36).substr(2, 9)}`;
const wrapperClass = responsive ? 'table-wrapper table-responsive' : 'table-wrapper';
---

<div class={wrapperClass}>
  <table 
    id={tableId}
    role="table"
    aria-label={ariaLabel || caption}
    aria-describedby={`${tableId}-caption`}
  >
    <caption id={`${tableId}-caption`}>
      {caption}
    </caption>
    
    <thead>
      <tr role="row">
        {headers.map(header => (
          <th scope="col" role="columnheader">
            {header}
          </th>
        ))}
      </tr>
    </thead>
    
    <tbody>
      {rows.map((row, rowIndex) => (
        <tr role="row">
          {row.map((cell, cellIndex) => {
            // First cell in row is a header if rowHeaders is true
            const isRowHeader = rowHeaders && cellIndex === 0;
            
            if (isRowHeader) {
              return (
                <th scope="row" role="rowheader">
                  {cell}
                </th>
              );
            } else {
              return (
                <td 
                  role="cell"
                  data-label={responsive ? headers[cellIndex] : undefined}
                >
                  {cell}
                </td>
              );
            }
          })}
        </tr>
      ))}
    </tbody>
  </table>
</div>

<!-- 
Usage Examples:

1. Simple data table:
<AccessibleTable 
  caption="Monthly Sales Data"
  headers={["Month", "Revenue", "Units Sold"]}
  rows={[
    ["January", "$10,000", "150"],
    ["February", "$12,000", "180"],
    ["March", "$15,000", "225"]
  ]}
/>

2. Table with row headers:
<AccessibleTable 
  caption="Product Comparison"
  headers={["Product", "Price", "Rating", "Availability"]}
  rows={[
    ["Widget A", "$29.99", "4.5/5", "In Stock"],
    ["Widget B", "$34.99", "4.2/5", "Out of Stock"],
    ["Widget C", "$24.99", "4.7/5", "In Stock"]
  ]}
  rowHeaders={true}
/>

3. Responsive mobile-friendly table:
<AccessibleTable 
  caption="User Activity Report"
  headers={["User", "Last Login", "Sessions", "Status"]}
  rows={[
    ["John Doe", "2024-01-15", "45", "Active"],
    ["Jane Smith", "2024-01-10", "23", "Inactive"],
    ["Bob Wilson", "2024-01-14", "67", "Active"]
  ]}
  responsive={true}
  ariaLabel="User activity data for the current month"
/>
-->

<style>
  /* Additional table-specific styles can go here */
  table {
    /* Ensure table respects container width */
    min-width: 100%;
  }
  
  /* Focus styles for keyboard navigation */
  th:focus,
  td:focus {
    outline: 2px solid var(--color-accent);
    outline-offset: -2px;
    background-color: var(--color-bg-accent);
  }
  
  /* Ensure adequate spacing for touch targets */
  @media (max-width: 768px) {
    th,
    td {
      min-height: 44px;
    }
  }
</style>